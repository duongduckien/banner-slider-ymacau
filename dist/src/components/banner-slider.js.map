{"version":3,"file":"banner-slider.js","sourceRoot":"","sources":["../../../src/components/banner-slider.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n    Component,\n    NgZone,\n    Input,\n    Output,\n    ElementRef,\n    OnDestroy,\n    OnChanges,\n    AfterViewInit,\n    AfterViewChecked,\n    EventEmitter,\n} from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\ndeclare const jQuery: any;\n\n@Component({\n    selector: 'banner-slider-ymacau',\n    templateUrl: 'banner-slider.html',\n    styleUrls: ['banner-slider.scss']\n})\nexport class BannerSliderComponent implements OnDestroy, OnChanges, AfterViewInit, AfterViewChecked {\n\n    @Input() config: any;\n    @Input() slider: any;\n    @Input() networkType: any;\n    @Input() onClickEvent: any;\n\n    @Output() afterChange: EventEmitter<any> = new EventEmitter();\n\n    private slideWrapper: any;\n    private lazyImages: any;\n    private initialized: boolean = false;\n    private packageName: string = 'Banner Slider YMacau';\n    private isAutoPlay: boolean = true;\n    private currentEl: any;\n    private statusPlayVideoOnNetwork: boolean = false;\n\n    constructor(\n        public zone: NgZone,\n        public domSanitizer: DomSanitizer,\n    ) {\n\n    }\n\n    ngOnInit() {\n\n    }\n\n    ngOnChanges() {\n        console.log(this.onClickEvent);\n        if (this.networkType === '3g' || this.networkType === '4g' || this.networkType === '5g') {\n            this.isAutoPlay = false;\n        }\n        if (this.currentEl && !this.isAutoPlay && this.onClickEvent) {\n            if (this.statusPlayVideoOnNetwork) {\n                this.handleActionVideo(this.currentEl, 'pause');\n                this.statusPlayVideoOnNetwork = false;\n            } else {\n                this.handleActionVideo(this.currentEl, 'play');\n                this.statusPlayVideoOnNetwork = true;\n            }\n        }\n    }\n\n    ngAfterViewInit(): void {\n        this.ngAfterViewChecked();\n    }\n\n    ngAfterViewChecked() {\n        if (this.slider.length > 0) {\n            if (!this.initialized) {\n                this.initSlider();\n            }\n        }\n    }\n\n    initSlider() {\n\n        this.zone.runOutsideAngular(() => {\n\n            this.slideWrapper = jQuery('.main-slider');\n            this.lazyImages = this.slideWrapper.find('.slide-image');\n\n            this.slideWrapper.on('init', (el: any) => {\n                this.zone.run(() => {\n                    this.initialized = true;\n                    el = jQuery(el.currentTarget);\n                    if (this.isAutoPlay) {\n                        this.handleActionVideo(el, 'play');\n                    }\n                });\n            });\n\n            this.slideWrapper.on('beforeChange', (el: any) => {\n                this.zone.run(() => {\n\n                    // Pause video when swipe slider when type of the network isn't wifi\n                    if (this.currentEl && !this.isAutoPlay) {\n                        this.handleActionVideo(this.currentEl, 'pause');\n                    }\n                    \n                    el = jQuery(el.currentTarget);\n                    if (this.isAutoPlay) {\n                        this.handleActionVideo(el, 'pause');\n                    }\n                });\n            });\n\n            this.slideWrapper.on('afterChange', (el: any) => {\n                this.zone.run(() => {\n\n                    el = jQuery(el.currentTarget);\n                    this.currentEl = el;\n                    const currentIndex = el.find('.slick-current').attr('data-slick-index');\n                    this.afterChange.emit({\n                        currentIndex: parseInt(currentIndex, 10) + 1,\n                        length: this.slider.length,\n                    });\n\n                    this.statusPlayVideoOnNetwork = false;\n\n                    if (this.isAutoPlay) {\n                        this.handleActionVideo(el, 'play');\n                    }\n\n                });\n            });\n\n            this.slideWrapper.on('lazyLoaded', (el: any) => {\n                this.zone.run(() => {\n                    this.lazyImages.addClass('show');\n                });\n            });\n\n            this.slideWrapper.on('destroy', (event, slick) => {\n                this.zone.run(() => {\n                    this.initialized = false;\n                });\n            });\n\n            this.slideWrapper.slick({\n                autoplaySpeed: 4000,\n                lazyLoad: 'progressive',\n                speed: 600,\n                arrows: false,\n                dots: true,\n                mobileFirst: true,\n                waitForAnimate: false,\n                adaptiveHeight: true,\n            });\n\n        });\n\n    }\n\n    /**\n     * @param  {any} player\n     * @param  {any} command\n     */\n    postMessageToPlayer(player: any, command: any) {\n        if (player == null || command == null) {\n            return;\n        }\n        player.contentWindow.postMessage(JSON.stringify(command), '*');\n    }\n\n    /**\n     * @param  {any} element\n     * @param  {any} control\n     */\n    handleActionVideo(element: any, control: any) {\n\n        let currentSlide = element.find('.slick-current');\n        let slideType = currentSlide.children().children().attr('class').split(' ')[1];\n        let player = currentSlide.find('iframe').get(0);\n\n        if (slideType === 'vimeo') {\n            switch (control) {\n                case 'play': {\n                    this.postMessageToPlayer(player, {\n                        'method': 'play',\n                        'value': 1,\n                    });\n                    break;\n                }\n                case 'pause': {\n                    this.postMessageToPlayer(player, {\n                        'method': 'pause',\n                        'value': 1,\n                    });\n                    break;\n                }\n            }\n        } else if (slideType === 'youtube') {\n            switch (control) {\n                case 'play': {\n                    this.postMessageToPlayer(player, {\n                        'event': 'command',\n                        'func': 'playVideo',\n                    });\n                    break;\n                }\n                case 'pause': {\n                    this.postMessageToPlayer(player, {\n                        'event': 'command',\n                        'func': 'pauseVideo',\n                    });\n                    break;\n                }\n            }\n        } else if (slideType === 'video') {\n            const video = currentSlide.children().children().children().children('video').get(0);\n            if (video != null) {\n                if (control === 'play') {\n                    video.play();\n                } else {\n                    video.pause();\n                }\n            }\n        }\n\n    }\n\n    /**\n     * @param  {string} url\n     * @param  {string} type\n     */\n    createSource(url: string, type: string) {\n        const vimeoConfig = this.config['vimeo']['params'];\n        const youtubeConfig = this.config['youtube']['params'];\n        if (vimeoConfig && youtubeConfig) {\n            switch (type) {\n                case 'youtube': {\n                    return `${url}?${this.queryParams(youtubeConfig)}`;\n                }\n                case 'vimeo': {\n                    return `${url}?${this.queryParams(vimeoConfig)}`;\n                }\n            }\n        }\n    }\n\n    /**\n     * @param  {any} params\n     */\n    queryParams(params: any) {\n        return Object.keys(params).map((key: any) => `${key}=${params[key]}`).join('&');\n    }\n\n    ngOnDestroy() {\n        this.slideWrapper = undefined;\n    }\n\n    /**\n     * @param  {string} label\n     * @param  {any} data\n     */\n    debug(label: string, data: any) {\n        console.log(`${this.packageName}: `, label, data);\n    }\n\n}\n"]}