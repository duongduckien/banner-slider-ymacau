{"version":3,"file":"banner-slider.js","sourceRoot":"","sources":["../../../src/components/banner-slider.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n    Component,\n    NgZone,\n    Input,\n    Output,\n    ElementRef,\n    OnDestroy,\n    OnChanges,\n    AfterViewInit,\n    AfterViewChecked,\n    EventEmitter,\n} from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\ndeclare const jQuery: any;\n\n@Component({\n    selector: 'banner-slider-ymacau',\n    templateUrl: 'banner-slider.html',\n    styleUrls: ['banner-slider.scss']\n})\nexport class BannerSliderComponent implements OnDestroy, OnChanges, AfterViewInit, AfterViewChecked {\n\n    @Input() config: any;\n    @Input() slider: any;\n    @Input() networkType: any;\n\n    @Output() afterChange: EventEmitter<any> = new EventEmitter();\n\n    private slideWrapper: any;\n    private lazyImages: any;\n    private initialized: boolean = false;\n    private packageName: string = 'Banner Slider YMacau';\n    private isAutoPlay: boolean = true;\n\n    constructor(\n        public zone: NgZone,\n        public domSanitizer: DomSanitizer,\n    ) {\n\n    }\n\n    ngOnInit() {\n\n    }\n\n    ngOnChanges() {\n        console.log('Network type', this.networkType);\n        if (this.networkType === '3g' || this.networkType === '4g' || this.networkType === '5g') {\n            this.isAutoPlay = false;\n        }\n    }\n\n    ngAfterViewInit(): void {\n        this.ngAfterViewChecked();\n    }\n\n    ngAfterViewChecked() {\n        if (this.slider.length > 0) {\n            if (!this.initialized) {\n                this.initSlider();\n            }\n        }\n    }\n\n    initSlider() {\n\n        this.zone.runOutsideAngular(() => {\n\n            this.slideWrapper = jQuery('.main-slider');\n            this.lazyImages = this.slideWrapper.find('.slide-image');\n\n            this.slideWrapper.on('init', (el: any) => {\n                this.zone.run(() => {\n                    this.initialized = true;\n                    el = jQuery(el.currentTarget);\n                    this.handleActionVideo(el, 'play');\n                });\n            });\n\n            this.slideWrapper.on('beforeChange', (el: any) => {\n                this.zone.run(() => {\n                    el = jQuery(el.currentTarget);\n                    this.handleActionVideo(el, 'pause');\n                });\n            });\n\n            this.slideWrapper.on('afterChange', (el: any) => {\n                this.zone.run(() => {\n                    el = jQuery(el.currentTarget);\n                    const currentIndex = el.find('.slick-current').attr('data-slick-index');\n                    this.afterChange.emit({\n                        currentIndex: parseInt(currentIndex, 10) + 1,\n                        length: this.slider.length,\n                    });\n                    this.handleActionVideo(el, 'play');\n                });\n            });\n\n            this.slideWrapper.on('lazyLoaded', (el: any) => {\n                this.zone.run(() => {\n                    this.lazyImages.addClass('show');\n                });\n            });\n\n            this.slideWrapper.on('destroy', (event, slick) => {\n                this.zone.run(() => {\n                    this.initialized = false;\n                });\n            });\n\n            this.slideWrapper.slick({\n                autoplaySpeed: 4000,\n                lazyLoad: 'progressive',\n                speed: 600,\n                arrows: false,\n                dots: true,\n                mobileFirst: true,\n                waitForAnimate: false,\n                adaptiveHeight: true,\n            });\n\n        });\n\n    }\n\n    /**\n     * @param  {any} player\n     * @param  {any} command\n     */\n    postMessageToPlayer(player: any, command: any) {\n        if (player == null || command == null) {\n            return;\n        }\n        player.contentWindow.postMessage(JSON.stringify(command), '*');\n    }\n\n    /**\n     * @param  {any} element\n     * @param  {any} control\n     */\n    handleActionVideo(element: any, control: any) {\n\n        let currentSlide = element.find('.slick-current');\n        let slideType = currentSlide.children().children().attr('class').split(' ')[1];\n        let player = currentSlide.find('iframe').get(0);\n\n        if (this.isAutoPlay) {\n            if (slideType === 'vimeo') {\n                switch (control) {\n                    case 'play': {\n                        this.postMessageToPlayer(player, {\n                            'method': 'play',\n                            'value': 1,\n                        });\n                        break;\n                    }\n                    case 'pause': {\n                        this.postMessageToPlayer(player, {\n                            'method': 'pause',\n                            'value': 1,\n                        });\n                        break;\n                    }\n                }\n            } else if (slideType === 'youtube') {\n                switch (control) {\n                    case 'play': {\n                        // this.postMessageToPlayer(player, {\n                        //     'event': 'command',\n                        //     'func': 'mute',\n                        // });\n                        this.postMessageToPlayer(player, {\n                            'event': 'command',\n                            'func': 'playVideo',\n                        });\n                        break;\n                    }\n                    case 'pause': {\n                        this.postMessageToPlayer(player, {\n                            'event': 'command',\n                            'func': 'pauseVideo',\n                        });\n                        break;\n                    }\n                }\n            } else if (slideType === 'video') {\n                const video = currentSlide.children().children().children().children('video').get(0);\n                if (video != null) {\n                    if (control === 'play') {\n                        video.play();\n                    } else {\n                        video.pause();\n                    }\n                }\n            }\n        }\n\n    }\n\n    /**\n     * @param  {string} url\n     * @param  {string} type\n     */\n    createSource(url: string, type: string) {\n        const vimeoConfig = this.config['vimeo']['params'];\n        const youtubeConfig = this.config['youtube']['params'];\n        if (vimeoConfig && youtubeConfig) {\n            switch (type) {\n                case 'youtube': {\n                    console.log(`${url}?${this.queryParams(youtubeConfig)}`);\n                    return `${url}?${this.queryParams(youtubeConfig)}`;\n                }\n                case 'vimeo': {\n                    console.log(`${url}?${this.queryParams(vimeoConfig)}`);\n                    return `${url}?${this.queryParams(vimeoConfig)}`;\n                }\n            }\n        }\n    }\n\n    /**\n     * @param  {any} params\n     */\n    queryParams(params: any) {\n        return Object.keys(params).map((key: any) => `${key}=${params[key]}`).join('&');\n    }\n\n    ngOnDestroy() {\n        this.slideWrapper = undefined;\n    }\n\n    /**\n     * @param  {string} label\n     * @param  {any} data\n     */\n    debug(label: string, data: any) {\n        console.log(`${this.packageName}: `, label, data);\n    }\n\n}\n"]}